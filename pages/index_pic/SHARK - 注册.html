<!DOCTYPE html>
<!-- saved from url=(0050)http://127.0.0.1:8848/pages/register/register.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
		<title>SHARK - 注册</title>
		<link rel="stylesheet" type="text/css" href="./SHARK - 注册_files/register.css">
		
		<script src="./SHARK - 注册_files/url_config.js"></script>
		<script src="./SHARK - 注册_files/vue.js"></script>
		<script src="./SHARK - 注册_files/jquery.js"></script>
		<script src="./SHARK - 注册_files/axios.js"></script>
		<script src="./SHARK - 注册_files/md5.js"></script>
	</head>

	<body class="bg-gradient">
		<div id="banner">
			<div id="logo" onclick="location.href=&#39;../index/index.html&#39;"></div>
		</div>
		
		<div class="notification-container"><div id="success" class="rectangle" style="display: none;"><div class="notification-text"><span>&nbsp;&nbsp;</span></div></div> <div id="error" class="rectangle"><div class="notification-text"><span>&nbsp;&nbsp;random shit</span></div></div></div>
		
		<div class="wrapper">
			<div class="container">
				<form id="register_form" class="form"><input type="text" placeholder="姓名" required="required"> <input type="text" placeholder="手机号" required="required" id="t"> <input type="password" placeholder="密码" required="required"> <input type="password" placeholder="确认密码" required="required" id="c"> <button type="button" id="register-button">注册</button> <br><br> <h5>已有账号？<a href="http://127.0.0.1:8848/pages/login/login.html" style="color: rgb(83, 227, 166);">去登录</a></h5><a href="http://127.0.0.1:8848/pages/login/login.html" style="color: rgb(83, 227, 166);"></a></form></div><a href="http://127.0.0.1:8848/pages/login/login.html" style="color: #53e3a6;">
		</a></div><a href="http://127.0.0.1:8848/pages/login/login.html" style="color: #53e3a6;">
	<script>document.write('<script src="//' + (location.host || 'localhost').split(':')[0] + ':35929/livereload.js?snipver=1"></' + 'script>')</script><script src="./SHARK - 注册_files/livereload.js"></script><script>document.addEventListener('LiveReloadDisconnect', function() { setTimeout(function() { window.location.reload(); }, 500); })</script>

	
<script type="text/javascript">
// configure baseURL
axios.defaults.baseURL = BaseURL;
// document.getElementById('success').style.display = 'none';
document.getElementById('error').style.display = '';
// Vue instance
new Vue({
	el:".notification-container",
	data:{
		success_message:"",
		error_message:"random shit"
	}
});

new Vue({
	el:"#register_form",
	data:{
		name:"",
		tel:"",
		password:"",
		confirm_password:""
	},
	methods:{
		tel_check(){
			if(this.tel.length != 11){
				document.getElementById("t").setCustomValidity("请输入11位手机号");
				document.getElementById("t").reportValidity();
				return;
			}
			axios.post('/user/tel_check',
						{
							'tel': this.tel,
						},
						{
							headers:{
							'Content-Type': 'application/json;charset=UTF-8',
							'Accept': 'application/json, text/plain, */*',
							'Auth': 'TO BE GENERATED AFTER LOGIN'
							}
						}
				)
			.then(function (response) {
				rst = response.data.data.exist;
				if(rst==true){
					document.getElementById("t").setCustomValidity("手机号已经被注册");
					return;
				}
				document.getElementById("t").setCustomValidity('');
			})
			.catch(function (error) {
				console.log(error);
			});
		},
		password_check(){
			if(this.password != this.confirm_password){
				document.getElementById("c").setCustomValidity("确认密码与密码不一致");
				return;
			}
			document.getElementById("c").setCustomValidity('');
		},
		register(){
			document.getElementById("register_form").reportValidity();
			if(this.tel == '' || this.password == '' || this.name == '' || this.confirm_password == ''){
				return;
			}
			if(document.getElementById("t").validity.customError == true){
				return;
			}
			if(document.getElementById("c").validity.customError == true){
				return;
			}
			axios.post('/user/register',
						{
							'tel': this.tel,
							'name': this.name,
							'password_hash': md5(this.password)
						},
						{
							headers:{
							'Content-Type': 'application/json;charset=UTF-8',
							'Accept': 'application/json, text/plain, */*',
							'Auth': 'TO BE GENERATED AFTER LOGIN'
							}
						}
				)
			.then(function (response) {
				if(response.data.success != 0){
					window.alert(response.data.message);
				}
				else{
					sessionStorage.setItem('tel', response.data.data.tel);
					window.alert("注册成功,跳转登录");
					window.location.href = "../login/login.html";
				}
			})
			.catch(function (error) {
			  console.log(error);
			});
		}
	}
}
);
</script>

</a></body></html>